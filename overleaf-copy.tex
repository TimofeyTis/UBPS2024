%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%  Sample document for preparing papers for  "Upravlenie bolshimi sistemami"
%%  charset=windows-1251
%%  The sample is based on the analogous sample of "Avtomatika i Telemekhanika".
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\documentclass[11pt]{ubs}
%%
%% для просмотра "as is" необходим набор русских шрифтов А. Лебедева
%% http://tex.imm.uran.ru/texserver/fonts/pscyr/pscyr4c/
%%

%_______________________________________________________________________________________________________
\usepackage{graphicx}
\usepackage{enumitem}
\usepackage{diagbox}
\usepackage{multirow}
\usepackage{empheq}
\usepackage{colortbl}
\usepackage{xcolor} % Для задания цветов
\DeclareMathOperator{\perprob}{P}
\DeclareMathOperator{\state}{\mathcal{S}}
\DeclareMathOperator{\action}{\mathcal{A}}

\definecolor{sfugrey}{RGB}{56,79,123}
%_______________________________________________________________________________________________________

\issue{XX}% Выпуск Сборника - проставляется в процессе верстки
\rubric{Программы и системы моделирования объектов, средств и систем управления}%  Рубрика Сборника - может быть скорректирована редактором
%
% Имеющиеся рубрики (последнюю информацию см. на сайте ubs.mtas.ru):
%
%    Системный анализ
%    Математическая теория управления
%    Анализ и синтез систем управления
%    Информационные технологии в управлении
%    Управление в социально-экономических системах
%    Управление в медико-биологических и экологических системах
%    Управление техническими системами и технологическими процессами
%    Управление подвижными объектами и навигация
%    Технические и программные средства управления
%    Надежность и диагностика средств и систем управления
%    Программы и системы моделирования объектов, средств и систем управления

% В соответствии с требованиями ВАК коды УДК и ББК обязательны. Проставляются автором. Могут быть скорректированы редактором
\udk{УДК ...} % Коды УДК можно найти на сайте https://classinform.ru/udk.html
\bbk{ББК ...} % Коды ББК можно найти на сайте https://classinform.ru/bbk.html

\title{Разработка адаптивной системы управления светофорными объектами с использованием марковских процессов принятия решений}% Название статьи
\engtitle{Article Title} % В соответствии с требованиями ВАК обязательно указывается название статьи на английском языке.

% Ссылка на грант и прочие благодарности. Оставьте команду \footnote и просто измените ее аргумент.
% Если ссылка не нужна, просто удалите следующую строку.
\thanks{\footnote{Работа поддержана Красноярским математическим центром, финансируемым Минобрнауки РФ (Соглашение 075-02-2024-1429).}}

% Список авторов должен вводиться в представленной форме. Авторы вводятся в алфавитном порядке.
% Сначала указывается Фамилия И.О., затем следует подстрочная ссылка (footnote) с полным именем,
% ученой степенью, должностью и контактной информацией (телефоном или e-mail-ом) автора,
% затем, с новой строки курсивом - организация, в которой работает автор.
% Если несколько подряд идущих авторов работают в одной организации, допускается перечислять их в одной строке,
% после которой идет строка с названием организации (см. пример ниже).
%
\authors{
%
\textbf{Тисленко~Т.И.}\footnote{Тисленко Тимофей Иванович, \emph{(}timtisko@mail.ru\emph{)}.},
\textbf{Семенова~Д.В.}\footnote{Семенова Дарья Владиславовна,\,д.ф.-м.н.,\,доцент {\makebox(20ex,1ex)[l]{\emph{(}DVSemenova@sfu-kras.ru\emph{).}
}
} }\\
\textit{\emph{(}Сибирский федеральный университет, г.~Красноярск\emph{)}}
%
}
%
\engauthors{% % В соответствии с требованиями ВАК обязательно указывается информация об авторах на английском языке.
\textbf{Alexander Ivanov}, Institute of Control Sciences of RAS,
Moscow, Cand.Sc., assistant professor (aaivanov@mail.ru). \\
\textbf{Boris Petrov}, Institute of Control Sciences of RAS, Moscow,
Doctor of Science, professor (Moscow, Profsoyuznaya st., 65,
(495)000-00-00). \\
\textbf{Vikor Sidorov}, Moscow Institute of Physics and Technology,
Moscow, student (viktor.sidorov@mipt.ru). }

\abstract{
В статье представлены результаты разработки программного комплекса MARLIN24, предназначенного для адаптивного управления светофорными \linebreak объектами. 
Структура комплекса включает  модуль адаптивного управления светофорными объектами, модуль симуляции движения транспорта и  модуль валидации. 
Математическая модель процесса управления светофорными \linebreak объектами --- управляемый марковский процесс с конечным числом действий и \linebreak  состояний. Задача поиска эффективного управления в целях  уменьшения суммарного времени нахождения  транспортных средств на детектируемых участках дорожной сети  сводится к задаче мультиагентного обучения с подкреплением (Multiagent Reinforcement Learning for Integrated Network, MARLIN).  Для поиска решения задачи MARLIN был построен алгоритм \linebreak $Q$-обучения.  
Структура программного комплекса также включает модуль  микросимуляции транспортных потоков  <<разумный водитель>> (Intelligent Driver Model, IDM).
Для имитации информации о реальной дорожной обстановке, поступающей в виде показаний оптического датчика,  в модуле валидации используются многомерные распределения, полученные с помощью применения копул Маршала-Олкина к маргинальным эмпирических распределениям для временных отметок  срабатывания оптического датчика.
Для построения маргинальных распределений использовались данные об интенсивности движения через детектируемые участки дорожной сети в период с 2019 по 2020 год.
}

% В соответствии с требованиями ВАК обязательно приводится расширенная аннотация на английском языке.
% Объем расширенной английской аннотации -- 150-200 слов.
% Английский текст проверяется редактором на предмет грамотности и соответствия русскому тексту и может быть изменен без согласования с авторами статьи.
\engabstract{%
% 150--200 words. Describes the standards of articles' formatting for "Large systems control" papers collection. Provides the examples for typical elements of an article. 150--200 words. Describes the standards of articles' formatting for "Large systems control" papers collection. Provides the examples for typical elements of an article. 150--200 words. Describes the standards of articles' formatting for "Large systems control" papers collection. Provides the examples for typical elements of an article. 150--200 words. Describes the standards of articles' formatting for "Large systems control" papers collection. Provides the examples for typical elements of an article.\newpage
}

% Обязательно указывается от трёх до шести ключевых слов
\keywords{
  имитационное моделирование транспортных потоков, модель IDM, модель MOBIL, копулы Маршалла-Олкина, машинное обучение с подкреплением}

% В соответствии с требованиями ВАК обязательно приводится перевод ключевых слов на английский язык.
\engkeywords{
  % large systems control, electronic scientific publication, article formatting template
}

\presented{...}% Член редколлегии, представляющий статью к публикации, заполняется редактором
\received{...}% Дата получения материала редакционной коллегией, заполняется  редактором
\published{...}% Дата опубликования статьи, заполняется редактором

\begin{document}

\maketitle

Одной из задач, решаемых в ходе реализации транспортной стратегии России на 2035 год \cite{transp_strat}, является увеличение пропускной способности и  скоростных параметров дорожной инфраструктуры до уровня лучших мировых достижений. При этом необходимо
учитывать  общесоциальные целевые ориентиры транспортной стратегии: подвижность населения, снижение аварийности, рисков и угроз безопасности по видам транспорта, снижение доли транспорта в загрязнении окружающей среды. Таким образом, актуальна проблема моделирования  транспортных потоков и оценки эффективности управления
светофорными объектами для наиболее нагруженных участков дорожной сети. %Эти инструменты  должны 

Системы, управляющие светофорными объектами, подразделяют на те, которые корректируют сигналы светофоров в реальном времени и реагируют на текущую дорожную обстановку --- АСУДД (адаптивные системы управления дорожным движением) и неадаптивные --- те, которые работают согласно фиксированному плану управления.
% Неадаптивные системы светофоров  переключают фазы светофоров через заранее заданное фиксированное время.
В таблице \ref{tab:adapt} представлены наиболее известные АСУДД, которые были разработаны в различные временные периоды и для различных условий движения.% (адаптивные системы управления дорожным движением).
\begin{table}[h!]
  \caption{Модели адаптивных систем управления дорожным движением
  \textcolor{red}{Поменять местами АСУДД и марлин}}
  \label{tab:adapt}
  \centering
  \scalebox{0.65}{
    \begin{tabular}{|c||c|c|c|c|c|c|}\hline
      \textbf{Критерий} & \textbf{UTCS-1}                       & \textbf{SCOOT}                          & \textbf{OPAC}                                                  & \parbox{0.2\textwidth}{\centering\rule{0em}{1.2em}\textbf{АСУДД} \\\textbf{<<Микро>>}\rule[-0.5em]{0em}{1.2em}} & \textbf{MARLIN}\\ \hline
      город             & Вашингтон                             & Лондон                                  & \parbox{0.2\textwidth}{\centering \rule{0em}{1.2em}Арлингтон,                                                                                    \\Тускон\rule[-0.5em]{0em}{1.2em}}  & Красноярск & Торонто\\ \hline
      \parbox{0.2\textwidth}{\centering\rule{0em}{1.2em}временной                                                                                                                                                                                            \\период} &1970е&1995&1983,1989& 2010 & 1993\\ \hline
      \parbox{0.2\textwidth}{\centering\rule{0em}{1.2em}длительность                                                                                                                                                                                         \\фаз\rule[-0.5em]{0em}{1.2em}} & \multicolumn{2}{c|}{фиксированная}  & \multicolumn{3}{c|}{переменная}  \\ \hline
      оптимизация       & офлайн                                & \multicolumn{4}{c|}{онлайн}                                                                                                                                                                \\ \hline
      предсказание      & нет                                   & \multicolumn{3}{c|}{есть}               &  есть                                                                             \\ \hline
      устройство        & \multicolumn{2}{c|}{централизованная} & \multicolumn{3}{c|}{децентрализованная}                                                                                                                                                    \\ \hline
      \parbox{0.2\textwidth}{\centering\rule{0em}{1.2em}основные                                                                                                                                                                                             \\ограничения\rule[-0.5em]{0em}{1.2em}}   & \parbox{0.2\textwidth}{\centering\rule{0em}{1.2em}постоянный\\сбор данных} & \parbox{0.15\textwidth}{\centering \rule{0em}{1.2em}сенсоры \\далеко} & \parbox{0.2\textwidth}{\centering \rule{0em}{1.2em}только для\\  8 фаз}&  \parbox{0.2\textwidth}{\centering \rule{0em}{1.2em}находится \\в разработке} & \parbox{0.25\textwidth}{\centering <<ПРОКЛЯТИЕ\\РАЗМЕРНОСТИ>>} \\ \hline
      работы, авторы &&&&&\\\hline
    \end{tabular}
  }
\end{table}

\textcolor{red}{Одной из первых была UTCS-1}

Система SCOOT (Split Cycle Offset Optimization Technique) анализирует данные о дорожной обстановке и корректирует светофорные сигналы, чтобы предотвратить образование заторов до их появления. Для работы данной системы требуется установка плотной сети индукционных петель, камер и других датчиков движения на расстоянии не менее  сорока метров и не более двухста метров до регулируемых перекрёстков. Централизованное управление SCOOT направлено на устранение <<эффекта волны>> \cite{}. Однако продолжительность каждого сигнала светофора (Split) не указывает на изменение времени активной фазы в реальном времени.

Система OPAC (Optimized Policies for Adaptive Control) — это адаптивная система управления светофорами, схожая по назначению с системой SCOOT, но использующая другой подход для оптимизации транспортных потоков. OPAC, разработанная в США, предназначена для улучшения дорожной ситуации в реальном времени путем адаптации фаз светофоров в зависимости от условий трафика. В системе OPAC существует ограничение в восемь фаз для каждого светофора. Это ограничение связано с практическими соображениями, поскольку каждая фаза представляет собой отдельное направление движения или определённую комбинацию разрешённых манёвров на перекрёстке (например, движение прямо, поворот налево или направо). Эти ограничения заложены аппаратно, то есть на уровне контроллеров, и не могут быть изменены конечным пользователем \cite{}.

Автоматизированная система управления дорожным движением (АСУДД) <<Микро>> \cite{ASUDD} — наиболее широко используемая в России система, успешно применяемая в следующих регионах:  Красноярский край, Иркутская область, Белгородская область, Воронежская область, Хабаровский край, Московская область. АСУДД <<Микро>> является децентрализованной системой и поддерживает до шести GPRS-серверов, которые позволяют подключить до 250 перекрёстков. Отечественные оптические детекторы серии <<Инфопро>>, используемые в АСУДД <<Микро>>, предназначены для сбора статистических данных о транспортном потоке и данных реального времени для актуального управления. Эти детекторы  работают на расстоянии до 100 метров. По дальности распознавания данные датчики не уступают их бельгийскому аналогу TrafiCam. Основным недостатком системы является тот факт, что реализация адаптивных алгоритмов  находится в стадии разработки \cite{}.

В работах \cite{MARL, MARLIN} для адпативного управления светофорными объектами было предложено использовать  метод мультиагентного обучения с подкреплением.  
Данный подход получил название MARLIN (Multiagent Reinforcement Learning for Integrated Network) и  был успешно применен в современной АСУДД в Канаде. Целью обучения с подкреплением является сокращение времени проезда транспортных средств через выбранные участки дорожной сети. Управление светофорными объектами считается эффективным, если транспортные средства находятся на детектируемых участках менее двух циклов.
 Для работы требуется установка камер на расстоянии менее ста метров от стоп-линий. Агенты (светофоры) могут работать без информации о полной дорожной обстановке и управлять движением децентрализованно. Перечисленные особенности можно отнести к достоинствам подхода на основе MARLIN. Существенным ограничением является рост вычислительной сложности при увеличении обзора агента, известный как <<проклятие размерности>>.

Фокус наших исследований сосредоточен на   разработке программных и математических инструментов для адаптивного управления сетью светофорных объектов участков дорожной сети города Красноярска. 
В настоящей работе представлин новый программный комплекс MARLIN24, реализующий часть методов новейших АСУДД. Оценка эффективности применяемого управления и валидация полученных результатов осуществляется с помощью симуляционных экспериментов на основе статистических данных с оптических детекторов за  2018 и 2019 года. 

% Как альтернатива к применяемым на практике АСУДД, в работе  предложен метод адаптивного управления, использующий  мультиагентное обучение с подкреплением (Multiagent Reinforcement Learning for Integrated Network, MARLIN)\cite{MARL}, основанные на марковских процессах принятия решений, которые могут и не оперировать интенсивностью проезда через поперечное сечение дороги.



% Во {введении }  дается краткий обзор наиболее известных систем адаптивного управления светофорными объектами. Приводятся особенности реализации.

Структура статьи следующая. В {параграфах  \ref{par:MARL_description}} и \ref{par:MARL_many_description}
проблема управления 
светофорными объектами сводится к задаче мультиагентного обучения с подкреплением для одного и нескольких агентов соответственно. 
\textcolor{red}{дописать текст из файлика в оверлифе}

\section{Общее описание \textcolor{red}{программного комплекса MARLIN24}}

Структура  программного комплекса MARLIN24 приведена на рисунке~\ref{fig:structure_MARLIN24} и состоит из четырех модулей:  симуляции,  валидации,  адаптивного управления светофорными объектами, визуализации. 
% \red{опционально отключаемы}
% \red{посмотреть статьи с приложениями/ перенести в приложения }

Модуль симуляции предназначен для оценки эффективности выбранного управления. 
Он реализует микросимуляционные модели движения, предназначенные для описания перемещения транспортных средств по дорожной сети. 
Часть программного кода, отвечающая за валидацию,  позволяет    моделировать интенсивности движения транспортных потоков. 
Включение графического интерфейса в модуле визуализации является опциональным и позволяет производить отладку применяемого управления. Данный модуль отображает транспортные средства, дорожную сеть, дополнительную информацию о содержании названий дорог, их координатах. Также в модуле реализована функция ускорения и замедления модельного времени, выделения маршрутов, масштабирования и перемещения области обзора.




\begin{figure}[tbph]
  \centering
  \includegraphics[width=0.99\textwidth]{structure.pdf}
  \caption{Структура программного комплекса MARLIN24}\label{fig:structure_MARLIN24}
\end{figure}


\input{simulation.tex}

\input{validation.tex}

\input{adapt.tex}


\input{calc.tex}


% \section{Описание задачи для одного агента}
% \label{par:MARL_description}


% Как правило, обучение с подкреплением используется для одного агента в среде, чтобы максимизировать его долгосрочную награду. В работе исследуется модель обучения с подкреплением нескольких агентов (светофорных объектов) в стохастической среде. Обучение с подкреплением сводится к оптимальному сопоставлению агентом действия $a$ состоянию среды $s$. Предложенная математическая модель процесса выбора фазы светофора учитывает текущее расположение светофоров и их загрузку и позволяет сформулировать оптимизационные задачи, целью которых является минимизация задержки движения автомобилей. Отметим, что структура мультиагентной системы обеспечивает наиболее эффективное распараллеливание всей задачи на подзадачи.

% Введём следующие обозначения: $ \state$ --- дискретное пространство состояний, $ \action$ --- дискретное пространство действий агента, $\delta \colon \state\to \action$ --- 


\newpage
% Авторы - по алфавиту, сначала русскоязычные, затем остальные.
\begin{thebibliography}{10}

\end{thebibliography}
\newpage
\makeenginfo
\makeauxinfo

\end{document}
