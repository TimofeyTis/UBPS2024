\section{Модуль валидации}
\label{par:MARLIN24_val}

\subsection{матмодель}
\subsection{описание модуля}

В модуле валидации  решается задача имитационного  моделирования интенсивности движения транспортного потока. 
Решение задачи моделирования зависимых распределений  среднесуточных интенсивностей состоит из двух этапов: этапа  предобработки и этапа имитационного моделирования.

В данной работе под интенсивностью транспортного потока будем понимать число автомобилей, проезжающих через поперечное сечение участка дорожной сети в единицу времени, а под среднесуточной интенсивностью --- усредненное количество машин по рабочим дням в течение года.
Ранее в работе \cite{OMSK} при описании интенсивности транспортного потока использовалась статистка, описывающая количество машин,
в работе  \cite{TOMSK}  использовалась величина временного интервала между проездом двух автомобилей через сечение участка дорожной сети.



Рассмотрим второй подход для введения в модель зависимых случайных величин.
В основе подхода лежит использование копул из семейства Маршал\-ла-Олкина \cite{marshall1996copulas}  для описания совместного распределения временных интервалов появления автомобилей.

Опишем совместное распределение интенсивностей движения для полос 7 и 8 рисунка \ref{fig:ex3}б.
Пусть случайная величина $X$ с функцией распределения $F(x)$ и   случайная величина $ Y$ с функцией распределения $G (y)$ описывают временной интервал между проездом двух автомобилей через сечение детектируемого участка на полосах 7 и 8 соответственно.
По теореме Скляра \cite{nelsen2006introduction} совместную функцию распределения можно представить копулой $C$
\begin{equation}\label{eq:Copula_H}
  H_{XY}(x,y)=C(F (x), G(y)), \qquad \forall x,y\in \mathbb{R}.
\end{equation}
\noindent



Далее будем использовать двупараметрическую копулу Маршалла-Ол\-ки\-на \cite{marshall1996copulas, Quesada} с коэффициентами $0\leqslant\alpha,\beta\leqslant1,$ $ \theta_1 = \alpha, \theta_2 = \beta$
\begin{equation} \label{eq:copula}
C(u_1, u_2, \dots, u_n) = \prod_{i=1}^{n} u_i^{1-\theta_i} \cdot \min(u_1^{\theta_1}, u_2^{\theta_2},\dots, u_n^{\theta_n}).
\end{equation}


Этап предобработки состоит в оценивании плотности распределений случайных величин $X$ и $Y,$ описывающих число детектируемых транспортных средств на полосах 1 и 2 соответственно на основе данных, полученных с оптических детекторов города Красноярска с 2019 по 2020 год. 
На первом шаге строятся ядерные оценки плотности с ядром Епанечникова \cite{Epanechnikov}. Далее формулируется упрощающее предположение о том, что каждая из рассматриваемых случайных величин представима в виде смеси нормальных распределений. 
С использованием EM-алгоритма \cite{EM}, на вход которого продавались значения ядерной оценки плотности, определяются параметры смесей.



Для этапа имитационного моделирования  среднесуточных интенсивностей (generator) была разработана модификация метода дискретной суперпозиции Монте-Карло для  генерации  значений случайной величины $(X,Y).$
% \begin{description}[itemsep=-3pt]
%   \item [\sf{этап 1:}] моделируем равномерно распределенные на отрезке $[0;\;1]$ случайные величины ${l}, {w};$
%   \item [\sf{этап 2:}] если выполняется $\sum\limits_{m=1}^{M} p_m <{l}< \sum\limits_{m=1}^{M+1}p_m,$ то функция распределения $M$-й компоненты смеси  $F = F_M;$
%   \item [\sf{этап 3:}] аналогично этапу 2, для ${w}$ определяем функцию распределения компоненты смеси $G;$
%   \item [\sf{этап 4:}] моделируем случайные величины $(U,V)$ согласно~{\cite{nelsen2006introduction}};
%   \item [\sf{этап 5:}] восстанавливаем $U$-квантиль $X_U$ распределения $F;$
%   \item [\sf{этап 6:}] восстанавливаем $V$-квантиль $Y_V$ распределения $G.$
% \end{description}


% \begin{example}
  Результаты  этапа предобработки  на 10-й итерации EM алгоритма и вид маргинальных плотностей  распределений случайных величин $X$  и $Y$ приведены на рисунке~\ref{fig:margin}а) и рисунке \ref{fig:margin}б) соответственно.
  \begin{figure}[tbph]
    \centering
    а)\includegraphics[width = 0.35\textwidth, trim={0 1cm 0 3.2cm}, clip]{EM_yad_oc_dens1.png}
    б)\includegraphics[width = 0.35\textwidth, trim={0 1cm 0 3.2cm}, clip]{EM_yad_oc_dens2.png}
    \caption{Результаты этапа предобработки: оценка плотностей маргинальных плотностей: а)случайной величины $X$; б) случайной величины $Y$}\label{fig:margin}
  \end{figure}
  \newpage

  Гистограмма выборки, полученной моделированием копулой Маршалла-Олкина с параметрами \(\alpha=0.9, \beta=0.25\) представлена на рисунке \ref{fig:revive_distrib}.

  \begin{figure}[tbph]
    \centering
    \includegraphics[width = 0.7\textwidth, trim={5.5cm 1cm 2cm 2cm}, clip]{EM_revive_density_function.png}
    \caption{Сравнение эмпирической  $f_{XY}^{*}$  и теоретической $f_{XY}$ функции плотности распределения $(X,Y)$ при моделировании значений $(U, V)$ для  копулы Маршалла-Олкина с параметрами  $\alpha=0.9, \beta=0.25$ }\label{fig:revive_distrib}
  \end{figure}
  
% \noindent
% \rule{0.95\textwidth}{0em}
% \end{example}